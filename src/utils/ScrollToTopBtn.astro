---
import { Icon } from 'astro-icon/components';
---

<button id='scrollToTopBtn'><Icon name='arrow-up' /></button>

<style>
  #scrollToTopBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: none;
    font-size: 3rem;
    background-color: var(--bg-graff);
    color: var(--green);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    z-index: 1000;
    transition: 0.3s all ease;
    animation: pulse 2s infinite;
  }

  #scrollToTopBtn:hover {
    color: var(--gradient);
  }

  @keyframes pulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.1);
    }
    100% {
      transform: scale(1);
    }
  }
</style>

<script>
  const mybutton = document.getElementById(
    'scrollToTopBtn',
  ) as HTMLButtonElement | null;

  window.onscroll = function () {
    scrollFunction();
  };

  function scrollFunction() {
    let scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop;

    let scrollHeight = document.documentElement.scrollHeight;

    let clientHeight = document.documentElement.clientHeight;

    // If the user has scrolled near the bottom of the page, show the button
    if (scrollTop + clientHeight >= scrollHeight - 400) {
      if (mybutton) {
        mybutton.style.display = 'flex';
      }
    } else {
      if (mybutton) {
        mybutton.style.display = 'none';
      }
    }
  }

  if (mybutton) {
    mybutton.onclick = function () {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    };
  }
</script>
